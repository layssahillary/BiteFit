<!-- <?php
require_once "conexao.php";

// Verifica se o usuário está logado como nutricionista
session_start();
if (!isset($_SESSION['nutricionista_id'])) {
  header("Location: login_nutricionista.php");
  exit();
}

// Verifica se o formulário foi submetido
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
  // Recebe os dados do formulário
  $nome = $_POST['nome'];
  $email = $_POST['email'];
  $data_nascimento = $_POST['data_nascimento'];
  $idade = calcularIdade($data_nascimento);
  $sexo = $_POST['sexo'];
  $altura = $_POST['altura'];
  $peso = $_POST['peso'];
  $senha = $_POST['senha'];

  // Verifica se os campos obrigatórios foram preenchidos
  if (empty($nome) || empty($email) || empty($data_nascimento) || empty($sexo) || empty($altura) || empty($peso) || empty($senha)) {
    $mensagem = "Por favor, preencha todos os campos obrigatórios.";
  } else {
    // Verifica se o email já está cadastrado
    $sql_verificar_email = "SELECT * FROM paciente WHERE email = ?";
    $stmt_verificar_email = $pdo->prepare($sql_verificar_email);
    $stmt_verificar_email->execute([$email]);

    if ($stmt_verificar_email->rowCount() > 0) {
      $mensagem = "O email informado já está cadastrado.";
    } else if (strlen($senha) < 8) {
      $mensagem = "A senha deve ter no mínimo 8 caracteres.";
    } else {
      // Insere os dados do paciente no banco de dados
      $sql  = "INSERT INTO paciente (nutricionista_id, nome, email, data_nascimento, idade, sexo, altura, peso, senha) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)";
      $stmt = $pdo->prepare($sql);
      $stmt->execute([$_SESSION['nutricionista_id'], $nome, $email, $data_nascimento, $idade, $sexo, $altura, $peso, $senha]);

      // Define uma mensagem de sucesso e redireciona de volta para a lista de pacientes
      $mensagem = "Paciente cadastrado com sucesso.";
      header("Location: pacientes.php?novo_paciente=1");
      exit();
    }
  }
} else {
  $mensagem = "Preencha os dados do paciente abaixo.";
}

// Função para calcular a idade a partir da data de nascimento
function calcularIdade($data_nascimento) {
  $agora = new DateTime();
  $nascimento = new DateTime($data_nascimento);
  $intervalo = $nascimento->diff($agora);
  return $intervalo->y;
}

// Exibe a mensagem de erro ou sucesso
if (isset($mensagem)) {
  echo "<p>{$mensagem}</p>";
}
?> -->

<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>Cadastro Pacientes | BiteFit</title>
        <meta name="description" content="Termos e Condições">
        <link rel="preload" href="./css/style.css" as="style">
        <link rel="stylesheet" href="./css/style.css">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@1,900&family=Poppins:wght@400;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
      

    </head>

<body id="cadastro">

    <header class="header-bg">
        <div class="header container">
            <a href="./">
                <img src="Group 1.svg" alt="Bikcraft">
            </a>
            
            <nav aria-label="primaria">
                <ul class="header-menu  font-2-l cor-0">
                    <li><a href="./perfil.html">Perfil</a></li>
                    <li><a href="./receitas.html">Receitas</a></li>
                    <li><a href="./sobre.html">Sobre</a></li>
                    
                </ul>
        </nav>
        </div>
    </header>

<main>
    <div class="titulo-bg">
        <div class="titulo container">
            <h1 class="font-1-xxl cor-0">Cadastrar Paciente<span class="cor-p1">.</span></h1>
        </div>        
    </div>


    <form id="formulario" method="POST" class="cadastro container" action="cadastro-paciente.html">

 
    <div class="cadastro-dados form">
        <h2 class="font-1-xs cor-9 col-2">Dados pessoais</h2>
        <div class="col-2">
            <label for="nome">Nome</label>
            <input type="text" id="nome" name="nome" required><br>
        </div>
        <div class="col-2">
            <label for="email">E-mail</label>
            <input type="email" id="email" name="email" required>
        </div>

        <div class="col-2">
            <label for="cpf">CPF</label>
            <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00">
        </div>
        <div class="col-1">
            <label for="senha">Senha:</label>
            <input type="password" id="senha" name="senha" required><br>
        </div>
        <h2 class="font-1-xs cor-9 col-2">entrega</h2>
        <div class="col-1">
            <label for="data_nascimento">Data de Nascimento:</label>
            <input type="date" id="data_nascimento" name="data_nascimento" required><br>
        </div>
        <div>
            <label for="sexo">Sexo:</label>
            <select id="sexo" name="sexo" required>
            <option value="">Selecione</option>
            <option value="M">Masculino</option>
            <option value="F">Feminino</option>
	        <option value="O">Outro</option>
            </select><br>
        </div>
        <div>
            <label for="altura">Altura:</label>
            <input type="number" id="altura" name="altura" step="0.01" required><br>
        </div>
        <div>
            <label for="peso">Peso:</label>
            <input type="number" id="peso" name="peso" step="0.01" required><br>
        </div>

        <button id="abrir-dialog" class="botao-cadastro col-1 " type="submit">Cadastrar</button>
        <dialog id="meu-dialog">
            <a id="fechar-dialog" >
                <img src="iconClose.svg" alt="texto-descritivo-da-imagem">
            </a>
            <h2 id="h2-cadastro">Cadastro feito <br>com sucesso! &#10024</h2>
        </dialog>
         
        <a class="botao-direita" href="homebitefit.html">Voltar</a>
        
    </div>
    </form>      
</main>
	

<footer class="footer-bg">
    <div class="footer container">
        <img src="Group 1.svg" alt="Bikcraft">
        <div class="footer-contato">
            <h3 class="font-2-l-b cor-0">Contato</h3>
            <ul class="font-2-m cor-5">
                <li><a href="tel:+5521999999999">+55 21 99999-9999</a></li>
                <li><a href="mailto:contato@bikcraft.com">contato@bikcraft.com</a></li>
                <li>Rua Ali Perto, 42 - Botafogo</li>
                <li>Rio de Janeiro - RJ</li>
            </ul>

            <div class="footer-redes">
                <a href="./">
                <img src="img/redes/instagram.svg" alt="Instagram"></a>
                <a href="./">
                    <img src="img/redes/facebook.svg" alt="facebook"></a>
                    <a href="./">
                        <img src="img/redes/youtube.svg" alt="youtube"></a>
            </div>
        </div>
        <div class="footer-informacoes">
            <h3 class="font-2-l-b cor-0">Informações</h3>
            <nav>
                <ul class="font-1-m cor-5">
                    <li><a href="./bicicletas.html">Inicio</a></li>
                    <li><a href="./seguros.html">Perfil</a></li>
                    <li><a href="./contato.html">Receitas</a></li>
                    <li><a href="./termos.html">Contato</a></li>
                </ul>
            </nav>
        </div>
        <p class="footer-copy font-2-m cor-6"> BiteFit Alguns direitos reservados.</p>
    </div>
</footer>

<script src="javascript/modal.js"></script>


    </body>
</html>